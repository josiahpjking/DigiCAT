'K5_1321', #beer/wine
'K5_1311', #tobacco
'K5_1341',#, #THC
'K5_DevVar19', # delinquency variety score
'K5_SCTRL',
#self-efficacy not available at K5
'K5_SchoolTeach',
'K5_SchoolClass',
'K5_SchoolDiffic',
'K5.6_MigHH2',
'K5.6_ISEImax',
'T4.3_ACHI01', #school achievement variables from earlier wave
'T4.3_ACHI02',
'T4.3_ACHI03'))
table(zp_read_all$ADR_GenderChild)
table(zp_read_all$K5.6_MigHH2)
descs17<-describe(zp_read_all[c('K5.6_ISEImax','K5_nSBQ_ANXDEP','K5_nSBQ_ADHD',
'K5_GTrust','K5_SCTRL',
'K5_1331', 'K5_1321','K5_1311', 'K5_1341',#liquor, beer/wine, tobacco, cannabis
'K5_nSBQ_REAGGR','K5_nSBQ_PHYSAGGR',
'K5_nSBQ_PROAGGR','K5_nSBQ_INDAGGR',
'K5_nSBQ_PROSO','K5_DevVar19', 'K5_involv',
'K5_ResilAdult','K5_ResilFriends','K5_BullVict4',
'K5_SchoolTeach','K5_SchoolClass','K5_SchoolDiffic',
'T4.3_ACHI01', #school achievement variables from earlier wave
'T4.3_ACHI02',
'T4.3_ACHI03')])
descs20<-describe(zp_read_all[c('K6_nSBQ_ANXDEP','K6_nSBQ_ADHD',
'K6_GTrust','K6_SCTRL',
'K6_N1331', 'K6_N1321','K6_N1311', 'K6_N1341',#liquor, beer/wine, tobacco, cannabis
'K6_nSBQ_REAGGR','K6_nSBQ_PHYSAGGR',
'K6_nSBQ_PROAGGR','K6_nSBQ_INDAGGR',
'K6_nSBQ_PROSO','K6_DevVar19', 'K6_involv',
'K5_ResilAdult','K5_ResilFriends','K6_BullVict4',
'K6_SchoolTeach','K6_SchoolClass','K6_SchoolDiffic',
'T4.3_ACHI01', #school achievement variables from earlier wave
'T4.3_ACHI02',
'T4.3_ACHI03'
)])
library(foreign); library(designmatch);library(car)
library(MatchIt); library(mice); library(sandwich)
library(psych);library(twang);library(MatchThem);library(cobalt)
library(lavaan); library(nbpMatching);library(tidyverse)
##prepare data####
zp1_8<-read.csv("data/zp_synth.csv") #z-proso waves 1 to 8
zp1_8$ID18A <- 1:nrow(zp1_8)
zp1_8 <- zp1_8 %>% dplyr::relocate(ID18A)
#subset variables
zp_read_all<-subset(zp1_8,
select=c('ID18A','ADR_GenderChild',
##treatment variable###
'K4_1451','K5_2501','K6_2501','K7_2501',  #reading at ages 11-17
##mental health outcomes wave 8 age 20###
'K8_651','K8_654','K8_655','K8_657', 'K8_681',                        #self-reported depression wave 8
'K8_683','K8_686','K8_689','K8_693',
'K8_652','K8_653','K8_656','K8_658',                                  #self-reported anxiety wave 8
'K8_682','K8_684','K8_687', 'K8_690','K8_692',
'K8_694',
##mental health outcomes at wave 7 age 17, anx & dep
'K7_651','K7_652','K7_653','K7_654','K7_655','K7_656','K7_657','K7_658',#
#mental health outcome at wave 6 age 15, anx & dep:
'K6_651','K6_652','K6_653','K6_654','K6_655','K6_656','K6_657','K6_658',#
#mental health outcomes at wave 5 age 13, anx & dep:
'K5_651','K5_652','K5_653','K5_654','K5_655','K5_656','K5_657','K5_658',#
#mental health outcomes at wave 4 age 11, anx & dep:
'K4_451','K4_452','K4_453','K4_454','K4_455','K4_456','K4_457','K4_458',
###covariates at age 17###
'K6_nSBQ_PROSO','K6_nSBQ_ANXDEP',
'K6_nSBQ_OPAGGR','K6_nSBQ_ADHD',
'K6_nSBQ_REAGGR','K6_nSBQ_PHYSAGGR',
'K6_nSBQ_PROAGGR','K6_nSBQ_INDAGGR',
'K6_involv', #parental involvement
'K6_ResilAdult','K6_ResilFriends',
'K6_BullVict4',
'K6_GTrust',
'K6_N1311',  #tobacco
'K6_N1321', #beer
'K6_N1331', #liquor
'K6_N1341', #THC
'K6_DevVar19',
'K6_SCTRL',
'K6_SchoolTeach',
'K6_SchoolClass',
'K6_SchoolDiffic',
'K5.6_MigHH2',
'K5.6_ISEImax',
#covariates at age 15
#covariates
'K5_nSBQ_PROSO','K5_nSBQ_ANXDEP',
'K5_nSBQ_OPAGGR','K5_nSBQ_ADHD',
'K5_nSBQ_REAGGR','K5_nSBQ_PHYSAGGR',
'K5_nSBQ_PROAGGR','K5_nSBQ_INDAGGR',
'K5_involv', #parental involvement
'K5_ResilAdult','K5_ResilFriends',
'K5_BullVict4',#
'K5_GTrust',#
'K5_1331', #liquor
'K5_1321', #beer/wine
'K5_1311', #tobacco
'K5_1341',#, #THC
'K5_DevVar19', # delinquency variety score
'K5_SCTRL',
#self-efficacy not available at K5
'K5_SchoolTeach',
'K5_SchoolClass',
'K5_SchoolDiffic',
'K5.6_MigHH2',
'K5.6_ISEImax',
'T4.3_ACHI01', #school achievement variables from earlier wave
'T4.3_ACHI02',
'T4.3_ACHI03'))
table(zp_read_all$ADR_GenderChild)
table(zp_read_all$K5.6_MigHH2)
descs17<-describe(zp_read_all[c('K5.6_ISEImax','K5_nSBQ_ANXDEP','K5_nSBQ_ADHD',
'K5_GTrust','K5_SCTRL',
'K5_1331', 'K5_1321','K5_1311', 'K5_1341',#liquor, beer/wine, tobacco, cannabis
'K5_nSBQ_REAGGR','K5_nSBQ_PHYSAGGR',
'K5_nSBQ_PROAGGR','K5_nSBQ_INDAGGR',
'K5_nSBQ_PROSO','K5_DevVar19', 'K5_involv',
'K5_ResilAdult','K5_ResilFriends','K5_BullVict4',
'K5_SchoolTeach','K5_SchoolClass','K5_SchoolDiffic',
'T4.3_ACHI01', #school achievement variables from earlier wave
'T4.3_ACHI02',
'T4.3_ACHI03')])
descs20<-describe(zp_read_all[c('K6_nSBQ_ANXDEP','K6_nSBQ_ADHD',
'K6_GTrust','K6_SCTRL',
'K6_N1331', 'K6_N1321','K6_N1311', 'K6_N1341',#liquor, beer/wine, tobacco, cannabis
'K6_nSBQ_REAGGR','K6_nSBQ_PHYSAGGR',
'K6_nSBQ_PROAGGR','K6_nSBQ_INDAGGR',
'K6_nSBQ_PROSO','K6_DevVar19', 'K6_involv',
'K5_ResilAdult','K5_ResilFriends','K6_BullVict4',
'K6_SchoolTeach','K6_SchoolClass','K6_SchoolDiffic',
'T4.3_ACHI01', #school achievement variables from earlier wave
'T4.3_ACHI02',
'T4.3_ACHI03'
)])
#first dichotomise reading, 0= <less than once a week, 1= once a week or more
zp_read_all$K4_read<-car::recode(zp_read_all$K4_1451, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp_read_all$K5_read<-car::recode(zp_read_all$K5_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp_read_all$K6_read<-car::recode(zp_read_all$K6_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp_read_all$K7_read<-car::recode(zp_read_all$K7_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
incomp_K6<-which(is.na(zp_read_all$K6_read))
zp_read_out17<-zp_read_all[-incomp_K6, ]
set.seed(555)
predmatrix<-matrix(nrow=dim(zp_read_out17)[2], ncol=dim(zp_read_out17)[2], data=rep(1,dim(zp_read_out17)[2]*dim(zp_read_out17)[2]))
predmatrix[c(1,3,4,5,6),]<-0 #remove ID variable,gender, pre-coded exposure  from imputation model
predmatrix[,c(1,3,4,5,6)]<-0
diag(predmatrix)<-0
zp_mice_all<-mice(zp_read_out17, m=10, predictorMatrix=predmatrix)
zp_read_out17
predmatrix
dim(zp_read_out17)
names(zp_read_out17)
names(zp_read_out17)[c(1,3,4,5,6)]
read.csv("data/zp_synth.csv") %>%
mutate(across(c(K4_1451,K5_2501,K6_2501,K7_2501),
~car::recode(.,'c(1,2)=0; c(3,4,5)=1; else=NA'))) %>%
filter(!is.na(K6_read))
read.csv("data/zp_synth.csv") %>%
mutate(across(c(K4_1451,K5_2501,K6_2501,K7_2501),
~list(read=car::recode(.,'c(1,2)=0; c(3,4,5)=1; else=NA')))) %>%
filter(!is.na(K6_2501_read))
read.csv("data/zp_synth.csv") %>%
mutate(across(c(K4_1451,K5_2501,K6_2501,K7_2501),
~list(read=car::recode(.,'c(1,2)=0; c(3,4,5)=1; else=NA'))))
read.csv("data/zp_synth.csv") %>%
mutate(across(c(K4_1451,K5_2501,K6_2501,K7_2501),
~list(read=car::recode(.,'c(1,2)=0; c(3,4,5)=1; else=NA')))) %>%
names()
zp <- read.csv("data/zp_synth.csv")
zp$K4_read<-car::recode(zp$K4_1451, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K5_read<-car::recode(zp$K5_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K6_read<-car::recode(zp$K6_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K7_read<-car::recode(zp$K7_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp <- read.csv("data/zp_synth.csv")
zp$K4_read<-car::recode(zp$K4_1451, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K5_read<-car::recode(zp$K5_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K6_read<-car::recode(zp$K6_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K7_read<-car::recode(zp$K7_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp <- zp[!is.na(zp$K6_read), ]
set.seed(555)
predmatrix<-matrix(nrow=dim(zp)[2], ncol=dim(zp)[2], data=rep(1,dim(zp)[2]*dim(zp)[2]))
predmatrix[c(1,3,4,5,6),]<-0 #remove ID variable,gender, pre-coded exposure  from imputation model
predmatrix[,c(1,3,4,5,6)]<-0
diag(predmatrix)<-0
zp_mice_all<-mice(zp, m=10, predictorMatrix=predmatrix)
zp_mice_all<-mice(zp, m=1, predictorMatrix=predmatrix)
zp_read_all_imp<-complete(zp_mice_all)
####PSM using MI for K7 outcomes####
# age 17 PSM outcome analyses not including prior reading:
Age17_matches<-matchthem(K6_read~ADR_GenderChild+K5.6_MigHH2+K5.6_ISEImax #sociodemographic matching variables
+K5_nSBQ_ANXDEP+K5_nSBQ_ADHD+     #MH/neurodevelopmental matching variables
K5_GTrust+K5_SCTRL  #wellbeing markers
+K5_1311+K5_1321+K5_1331+K5_1341+ #substance use
K5_nSBQ_REAGGR+K5_nSBQ_PHYSAGGR+
K5_nSBQ_PROAGGR+K5_nSBQ_INDAGGR+
K5_nSBQ_PROSO+K5_DevVar19   #prosocial+antisocial traits
+K5_involv+K5_ResilAdult+K5_ResilFriends+K5_BullVict4  #social risk/protective factors
+K5_SchoolTeach+K5_SchoolClass # teacher & class bond
+K5_SchoolDiffic+ #school commitment and difficulties
T4.3_ACHI01+T4.3_ACHI02+T4.3_ACHI03, #achievement at school
datasets=zp_mice_all, approach='within', method='nearest',link='logit', tols=.10, ratio=1)
bal.tab(Age17_matches)#assess quality of matching
names(zp)
names(zp)
rename
/rename
?rename
zp %>% rename(
Gender = ADR_GenderChild,
AnxietyDepression = K5_nSBQ_ANXDEP
)
zp %>% transmute(
Gender = ADR_GenderChild,
Anxiety = K7_652+K7_653+K7_656+K7_658,
Reading = K6_read,
AnxietyDepression = K5_nSBQ_ANXDEP,
Trust = K5_GTrust,
SelfControl = K5_SCTRL,
SubstanceUse1 = K5_1311,
SubstanceUse2 = K5_1321,
SubstanceUse3 = K5_1331,
SubstanceUse4 = K5_1341,
TeacherBond = K5_SchoolTeach,
ClassBond = K5_SchoolClass,
SchoolDifficulties = K5_SchoolDiffic,
Achievements1 = T4.3_ACHI01,
Achievements2 = T4.3_ACHI02,
Achievements3 = T4.3_ACHI03,
K5_nSBQ_REAGGR,
K5_nSBQ_PHYSAGGR,
K5_nSBQ_PROAGGR,
K5_nSBQ_INDAGGR,
K5_nSBQ_PROSO,
K5_DevVar19,
K5_involv,
K5_ResilAdult,
K5_ResilFriends,
K5_BullVict4
)
set.seed(555)
predmatrix<-matrix(nrow=dim(zp)[2], ncol=dim(zp)[2], data=rep(1,dim(zp)[2]*dim(zp)[2]))
zp <- read.csv("data/zp_synth.csv")
zp$K4_read<-car::recode(zp$K4_1451, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K5_read<-car::recode(zp$K5_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K6_read<-car::recode(zp$K6_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K7_read<-car::recode(zp$K7_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp <- zp[!is.na(zp$K6_read), ]
zp <- zp %>% transmute(
Gender = ADR_GenderChild,
Anxiety = K7_652+K7_653+K7_656+K7_658,
Reading = K6_read,
AnxietyDepression = K5_nSBQ_ANXDEP,
Trust = K5_GTrust,
SelfControl = K5_SCTRL,
SubstanceUse1 = K5_1311,
SubstanceUse2 = K5_1321,
SubstanceUse3 = K5_1331,
SubstanceUse4 = K5_1341,
TeacherBond = K5_SchoolTeach,
ClassBond = K5_SchoolClass,
SchoolDifficulties = K5_SchoolDiffic,
Achievements1 = T4.3_ACHI01,
Achievements2 = T4.3_ACHI02,
Achievements3 = T4.3_ACHI03,
K5_nSBQ_REAGGR,
K5_nSBQ_PHYSAGGR,
K5_nSBQ_PROAGGR,
K5_nSBQ_INDAGGR,
K5_nSBQ_PROSO,
K5_DevVar19,
K5_involv,
K5_ResilAdult,
K5_ResilFriends,
K5_BullVict4
)
zp
names(xp)
names(zp)
set.seed(555)
predmatrix<-matrix(nrow=dim(zp)[2], ncol=dim(zp)[2], data=rep(1,dim(zp)[2]*dim(zp)[2]))
predmatrix[c(1),]<-0
predmatrix[,c(1)]<-0
diag(predmatrix)<-0
names(zp)
zp_mice_all<-mice(zp, m=1, predictorMatrix=predmatrix)
zp_read_all_imp<-complete(zp_mice_all)
# age 17 PSM outcome analyses not including prior reading:
Age17_matches<-matchthem(K6_read~ADR_GenderChild+K5.6_MigHH2+K5.6_ISEImax #sociodemographic matching variables
+K5_nSBQ_ANXDEP+K5_nSBQ_ADHD+     #MH/neurodevelopmental matching variables
K5_GTrust+K5_SCTRL  #wellbeing markers
+K5_1311+K5_1321+K5_1331+K5_1341+ #substance use
K5_nSBQ_REAGGR+K5_nSBQ_PHYSAGGR+
K5_nSBQ_PROAGGR+K5_nSBQ_INDAGGR+
K5_nSBQ_PROSO+K5_DevVar19   #prosocial+antisocial traits
+K5_involv+K5_ResilAdult+K5_ResilFriends+K5_BullVict4  #social risk/protective factors
+K5_SchoolTeach+K5_SchoolClass # teacher & class bond
+K5_SchoolDiffic+ #school commitment and difficulties
T4.3_ACHI01+T4.3_ACHI02+T4.3_ACHI03, #achievement at school
datasets=zp_mice_all, approach='within', method='nearest',link='logit', tols=.10, ratio=1)
paste(names(zp), collapse=" + ")
zp <- read.csv("data/zp_synth.csv")
zp$K4_read<-car::recode(zp$K4_1451, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K5_read<-car::recode(zp$K5_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K6_read<-car::recode(zp$K6_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K7_read<-car::recode(zp$K7_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp <- zp[!is.na(zp$K6_read), ]
zp <- zp %>% transmute(
Gender = ADR_GenderChild,
Anxiety_age17 = K7_652+K7_653+K7_656+K7_658,
Reading_age15 = K6_read,
AnxietyDepression_age13 = K5_nSBQ_ANXDEP,
Trust_age13 = K5_GTrust,
SelfControl_age13 = K5_SCTRL,
SubstanceUse1_age13 = K5_1311,
SubstanceUse2_age13 = K5_1321,
SubstanceUse3_age13 = K5_1331,
SubstanceUse4_age13 = K5_1341,
TeacherBond_age13 = K5_SchoolTeach,
ClassBond_age13 = K5_SchoolClass,
SchoolDifficulties_age13 = K5_SchoolDiffic,
Achievements1_age13 = T4.3_ACHI01,
Achievements2_age13 = T4.3_ACHI02,
Achievements3_age13 = T4.3_ACHI03,
K5_nSBQ_REAGGR,
K5_nSBQ_PHYSAGGR,
K5_nSBQ_PROAGGR,
K5_nSBQ_INDAGGR,
K5_nSBQ_PROSO,
K5_DevVar19,
K5_involv,
K5_ResilAdult,
K5_ResilFriends,
K5_BullVict4
)
set.seed(555)
predmatrix<-matrix(nrow=dim(zp)[2], ncol=dim(zp)[2], data=rep(1,dim(zp)[2]*dim(zp)[2]))
predmatrix[c(1),]<-0
predmatrix[,c(1)]<-0
diag(predmatrix)<-0
zp_mice_all<-mice(zp, m=1, predictorMatrix=predmatrix)
zp_read_all_imp<-complete(zp_mice_all)
# age 17 PSM outcome analyses not including prior reading:
Age17_matches<-matchthem(Reading_age15~
Gender + AnxietyDepression_age13 + Trust_age13 + SelfControl_age13 +
SubstanceUse1_age13 + SubstanceUse2_age13 +
SubstanceUse3_age13 + SubstanceUse4_age13 +
TeacherBond_age13 + ClassBond_age13 + SchoolDifficulties_age13 +
Achievements1_age13 + Achievements2_age13 + Achievements3_age13 +
K5_nSBQ_REAGGR + K5_nSBQ_PHYSAGGR + K5_nSBQ_PROAGGR + K5_nSBQ_INDAGGR +
K5_nSBQ_PROSO + K5_DevVar19 +
K5_involv + K5_ResilAdult + K5_ResilFriends + K5_BullVict4,
datasets=zp_mice_all, approach='within', method='nearest',link='logit', tols=.10, ratio=1)
bal.tab(Age17_matches)#assess quality of matching
?bal.tab
#anxiety age 17 outcome analysis (no adjustemtn:
summary(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15))))
zp_mice_all<-mice(zp, m=5, predictorMatrix=predmatrix)
zp_read_all_imp<-complete(zp_mice_all)
# age 17 PSM outcome analyses not including prior reading:
Age17_matches<-matchthem(Reading_age15~
Gender + AnxietyDepression_age13 + Trust_age13 + SelfControl_age13 +
SubstanceUse1_age13 + SubstanceUse2_age13 +
SubstanceUse3_age13 + SubstanceUse4_age13 +
TeacherBond_age13 + ClassBond_age13 + SchoolDifficulties_age13 +
Achievements1_age13 + Achievements2_age13 + Achievements3_age13 +
K5_nSBQ_REAGGR + K5_nSBQ_PHYSAGGR + K5_nSBQ_PROAGGR + K5_nSBQ_INDAGGR +
K5_nSBQ_PROSO + K5_DevVar19 +
K5_involv + K5_ResilAdult + K5_ResilFriends + K5_BullVict4,
datasets=zp_mice_all, approach='within', method='nearest',link='logit', tols=.10, ratio=1)
bal.tab(Age17_matches) #assess quality of matching
#anxiety age 17 outcome analysis (no adjustemtn:
summary(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15))))
names(zp)
names(zp)
names(zp)[-c(1:3)]
names(zp)[-c(2:3)]
zp <- read.csv("data/zp_synth.csv")
zp$K4_read<-car::recode(zp$K4_1451, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K5_read<-car::recode(zp$K5_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K6_read<-car::recode(zp$K6_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp$K7_read<-car::recode(zp$K7_2501, 'c(1,2)=0; c(3,4,5)=1; else=NA')
zp <- zp[!is.na(zp$K6_read), ]
zp <- zp %>% transmute(
Gender = ADR_GenderChild,
Anxiety_age17 = K7_652+K7_653+K7_656+K7_658,
Reading_age15 = K6_read,
AnxietyDepression_age13 = K5_nSBQ_ANXDEP,
Trust_age13 = K5_GTrust,
SelfControl_age13 = K5_SCTRL,
SubstanceUse1_age13 = K5_1311,
SubstanceUse2_age13 = K5_1321,
SubstanceUse3_age13 = K5_1331,
SubstanceUse4_age13 = K5_1341,
TeacherBond_age13 = K5_SchoolTeach,
ClassBond_age13 = K5_SchoolClass,
SchoolDifficulties_age13 = K5_SchoolDiffic,
Achievements1_age13 = T4.3_ACHI01,
Achievements2_age13 = T4.3_ACHI02,
Achievements3_age13 = T4.3_ACHI03,
K5_nSBQ_REAGGR,
K5_nSBQ_PHYSAGGR,
K5_nSBQ_PROAGGR,
K5_nSBQ_INDAGGR,
K5_nSBQ_PROSO,
K5_DevVar19,
K5_involv,
K5_ResilAdult,
K5_ResilFriends,
K5_BullVict4
)
write_csv(zp,file="data/zp_eg.csv")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?bal.tab
runApp()
zp <- read_csv("data/zp_eg.csv")
library(tidyverse)
# write_csv(zp,file="data/zp_eg.csv")
zp <- read_csv("data/zp_eg.csv")
library(foreign); library(designmatch);library(car)
library(MatchIt); library(mice); library(sandwich)
library(psych);library(twang);library(MatchThem);library(cobalt)
library(lavaan); library(nbpMatching);library(tidyverse)
# write_csv(zp,file="data/zp_eg.csv")
zp <- read_csv("data/zp_eg.csv")
set.seed(555)
predmatrix<-matrix(nrow=dim(zp)[2], ncol=dim(zp)[2], data=rep(1,dim(zp)[2]*dim(zp)[2]))
predmatrix[c(1),]<-0
predmatrix[,c(1)]<-0
diag(predmatrix)<-0
zp_mice_all<-mice(zp, m=10, predictorMatrix=predmatrix)
zp_read_all_imp<-complete(zp_mice_all)
# age 17 PSM outcome analyses not including prior reading:
Age17_matches<-matchthem(Reading_age15~
Gender + AnxietyDepression_age13 + Trust_age13 + SelfControl_age13 +
SubstanceUse1_age13 + SubstanceUse2_age13 +
SubstanceUse3_age13 + SubstanceUse4_age13 +
TeacherBond_age13 + ClassBond_age13 + SchoolDifficulties_age13 +
Achievements1_age13 + Achievements2_age13 + Achievements3_age13 +
K5_nSBQ_REAGGR + K5_nSBQ_PHYSAGGR + K5_nSBQ_PROAGGR + K5_nSBQ_INDAGGR +
K5_nSBQ_PROSO + K5_DevVar19 +
K5_involv + K5_ResilAdult + K5_ResilFriends + K5_BullVict4,
datasets=zp_mice_all, approach='within', method='nearest',link='logit', tols=.10, ratio=1)
bal.tab(Age17_matches) #assess quality of matching
save(Age17_matches,zp_mice_all,zp_read_all_imp,file="data/zp_example.RData")
library(shiny)
library(shinyjs)
library(shinyWidgets)
library(bsplus)
bal.plot(Age17_matches)
runApp()
cobalt::bal.tab(Age17_matches)
cobalt::bal.tab(Age17_matches) %>% class
cobalt::bal.tab(Age17_matches) %>% as_tibble()
cobalt::bal.tab(Age17_matches) %>% str
cobalt::bal.plot(Age17_matches) %>% class
runApp()
runApp()
runApp()
summary(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15))))
pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15)))
summary(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15))))
broom::tidy(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15))))
summary(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15))))
as_tibble(summary(pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15)))))
tab_model((pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15)))))
sjPlot::tab_model((pool(with(Age17_matches,
lm(Anxiety_age17~Reading_age15)))))
sjPlot::tab_model(broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15)))))
knitr::kable(broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15)))))
knitr::kable(broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15)))), format = "html")
runApp()
runApp()
runApp()
broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15))))
broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15))))[,1:5]
broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15))))[,1:5] %>%
mutate(across(estimate:p.value, round(.3)))
broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15))))[,1:5] %>%
mutate(across(c(estimate:p.value), round(3)))
broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15))))[,1:5] %>%
mutate(across(c(estimate:p.value), ~round(3)))
broom::tidy(pool(with(Age17_matches, lm(Anxiety_age17~Reading_age15))))[,1:5] %>%
mutate(across(c(estimate:p.value), ~round(.,3)))
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
load("data/zp_example.RData")
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
